# Data Model: In-Memory Python Todo Console App

**Feature**: 001-inmemory-todo-cli
**Date**: 2026-01-01
**Status**: Complete

## Entities

### Task

The core entity representing a todo item.

**Location**: `src/models/task.py`

```python
from dataclasses import dataclass, field

@dataclass
class Task:
    """Represents a single todo item."""

    id: int
    title: str
    description: str = ""
    is_complete: bool = False
```

**Fields**:

| Field | Type | Required | Default | Constraints |
|-------|------|----------|---------|-------------|
| `id` | `int` | Yes | N/A | Positive integer, auto-generated, unique, sequential |
| `title` | `str` | Yes | N/A | 1-200 characters, non-empty, non-whitespace-only |
| `description` | `str` | No | `""` | 0-1000 characters |
| `is_complete` | `bool` | No | `False` | Toggleable between True/False |

**Validation Rules**:

1. **ID Validation**:
   - Must be a positive integer (> 0)
   - Generated by TaskService, not user-provided

2. **Title Validation**:
   - Must not be empty or whitespace-only
   - Maximum 200 characters (truncate with warning if exceeded)
   - Stripped of leading/trailing whitespace before storage

3. **Description Validation**:
   - Optional (defaults to empty string)
   - Maximum 1000 characters (truncate with warning if exceeded)
   - Stripped of leading/trailing whitespace before storage

4. **Completion Status**:
   - Binary state: complete (True) or incomplete (False)
   - Defaults to incomplete on creation

## Storage Model

### TaskStore (In-Memory)

**Location**: `src/services/task_service.py` (internal to TaskService)

```python
class TaskService:
    """Manages task storage and operations."""

    def __init__(self) -> None:
        self._tasks: dict[int, Task] = {}
        self._next_id: int = 1
```

**Storage Characteristics**:

| Property | Value |
|----------|-------|
| Type | In-memory dictionary |
| Key | Task ID (int) |
| Value | Task instance |
| Persistence | None (lost on exit) |
| Concurrency | Not supported (single-threaded) |

**ID Generation**:

```python
def _generate_id(self) -> int:
    """Generate the next sequential ID."""
    id = self._next_id
    self._next_id += 1
    return id
```

- IDs start at 1
- Increment monotonically
- Never reused after deletion

## State Transitions

### Task Lifecycle

```
                    [Add Task]
                        |
                        v
    +-------------------------------------------+
    |              INCOMPLETE                    |
    |  (is_complete = False)                    |
    +-------------------------------------------+
          |                           ^
          | [Mark Complete]           | [Mark Incomplete]
          v                           |
    +-------------------------------------------+
    |               COMPLETE                     |
    |  (is_complete = True)                     |
    +-------------------------------------------+
          |
          | [Delete Task]
          v
    +-------------------------------------------+
    |               DELETED                      |
    |  (removed from storage)                   |
    +-------------------------------------------+
```

**State Transitions**:

| From | Action | To | Reversible |
|------|--------|-----|------------|
| (none) | Add Task | INCOMPLETE | N/A |
| INCOMPLETE | Mark Complete | COMPLETE | Yes |
| COMPLETE | Mark Incomplete | INCOMPLETE | Yes |
| INCOMPLETE | Delete | (removed) | No |
| COMPLETE | Delete | (removed) | No |
| INCOMPLETE | Update | INCOMPLETE | Yes (data change) |
| COMPLETE | Update | COMPLETE | Yes (data change) |

## Relationships

This Phase I implementation has a single entity (Task) with no relationships. Future phases may introduce:
- User → Tasks (one-to-many)
- Task → Categories/Tags (many-to-many)
- Task → Subtasks (one-to-many, self-referential)

## Data Integrity

**Invariants**:

1. Task IDs are unique within the store
2. Task IDs are always positive integers
3. All tasks have a non-empty title
4. The `_next_id` counter is always greater than the highest existing task ID

**Enforcement**:

- ID generation managed solely by TaskService
- Title validation occurs before task creation/update
- No external access to internal storage structure
